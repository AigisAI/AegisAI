package org.aegisai.entity;

import jakarta.persistence.*;
import lombok.*;

@Entity
@Table(name = "vulnerability")
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
@AllArgsConstructor
@Builder
public class Vulnerability {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "vulnerability_id")
    private Long vulnerabilityId;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "analysis_id", nullable = false)
    @Setter
    private Analysis analysis;

    /*
    @Column(name = "message", length = 5000, nullable = false)
    private String message;
    */
    // name 속성 제거
    @Column(length = 5000, nullable = false)
    private String message;

    // @Column(name = "linenumber")
    @Column
    private Integer lineNumber;

    // @Column(name = "codesnippet", columnDefinition = "TEXT")
    @Column(columnDefinition = "TEXT")
    private String codeSnippet;

    //@Column(name = "severity", length = 50)
    @Column(length = 50)
    private String severity;

    //@Column(name = "cwelink", length = 255)
    @Column(length = 255)
    private String cweLink;

    // 비즈니스 로직
    public void updateSeverity(String severity) {
        this.severity = severity;
    }

    public void updateMessage(String message) {
        this.message = message;
    }
}
